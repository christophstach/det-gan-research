description: "CelebA HQ - MSG - ZSkip - EMA - RaLSGAN - WGAN div - Pack2 - g:leakyReLU/d:leakyReLU - g:PixelNorm/d:SpectralNorm - 64x64"
entrypoint: msg_gan:MsgGANTrail

# records_per_epoch: 60000 # for mnist
# records_per_epoch: 30000 # for celebAHQ
# records_per_epoch: 70000 # for ffhq
# records_per_epoch: 63632 # for anime-face

searcher:
  name: single
  metric: inception_score
  smaller_is_better: false
  max_length:
    batches: 500000

min_validation_period:
  batches: 500

min_checkpoint_period:
  batches: 10000

resources:
  slots_per_trial: 1
  agent_label: dt-cluster

checkpoint_storage:
  save_trial_best: 1
  save_trial_latest: 1
  save_experiment_best: 1

hyperparameters:
  global_batch_size: 32

  # dataset: anime-face
  dataset: celeba-hq
  image_size: 64
  image_channels: 3
  latent_dimension: 16

  msg: true
  pack: 2
  loss_fn: RaLSGAN
  ema: true
  ema_decay: 0.999
  instance_noise_until: 0
  clip_grad_norm: 0

  # IMPROVING GENERALIZATION AND STABILITY OF
  # GENERATIVE ADVERSARIAL NETWORKS
  gradient_penalty_type: WGAN-div
  gradient_penalty_coefficient: 2.0
  gradient_penalty_center: 0.0
  gradient_penalty_power: 6
  gradient_penalty_norm_type: l2
  gradient_penalty_penalty_type: ls

  path_length_regularizer_coefficient: 0.0
  g_orthogonal_regularizer_coefficient: 0.0
  d_orthogonal_regularizer_coefficient: 0.0

  g_optimizer: Adam
  g_lr: 0.0001
  g_b1: 0.5
  g_b2: 0.999

  d_optimizer: Adam
  d_lr: 0.0001
  d_b1: 0.5
  d_b2: 0.999

  g_depth: 5
  g_min_filters: 0
  g_max_filters: 0

  d_depth: 5
  d_min_filters: 0
  d_max_filters: 0

  g_activation_fn: lrelu
  g_normalization: pixel
  g_spectral_normalization: true

  d_activation_fn: lrelu
  d_normalization: passthrough
  d_spectral_normalization: true

  inception_score_images: 2048
  evaluation_model: "vggface2"

environment:
  image:
    cpu: "deepprojects/determined-pytorch-1.7-tf-2.4-cpu"
    gpu: "deepprojects/determined-cuda-110-pytorch-1.7-tf-2.4-gpu"

bind_mounts:
  - host_path: /data/ldap/stachc/datasets
    container_path: /datasets
    read_only: true